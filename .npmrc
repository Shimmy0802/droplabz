# CRITICAL FIX: Use Yarn's npm registry mirror (more stable than npm.org)
# This bypasses npm.org registry outages/connectivity issues
registry=https://registry.yarnpkg.com/

# Fallback to Yarn's alternate registry if primary fails
@babel/eslint-parser@npm:
@babel/*:registry=https://npm.pkg.github.com/
@solana/*:registry=https://npm.pkg.github.com/

# FAILSAFE: If all else fails, this allows falling back to npm.org
# But Yarn registry should handle 99% of packages
# registry=https://registry.npmjs.org/

# Enable strict SSL to prevent MitM attacks
strict-ssl=true

# CRITICAL: Extended timeouts for registry fallback scenarios
# Allows time for registry failover without immediate timeout
fetch-timeout=180000
fetch-retry-mintimeout=30000
fetch-retry-maxtimeout=180000
fetch-retries=10

# Prefer offline to avoid registry flooding
prefer-offline=true

# Disable script execution during install (can cause timeouts in CI)
ignore-scripts=true

# Store directory for monorepo optimization
store-dir=.pnpm-store

# Free tier optimization: Sequential package fetches
# Prevents concurrent registry connections that fail on limited bandwidth
shamefully-hoist=false
strict-peer-dependencies=false

# NODE_OPTIONS tuning for Vercel free tier (limited memory)
node-linker=pnpm

# Auto-install peer dependencies
auto-install-peers=true
